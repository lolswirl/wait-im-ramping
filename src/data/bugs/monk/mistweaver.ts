import SPELLS from '@data/spells/index';
import TALENTS from '@data/talents/monk/mistweaver';
import { STATS, STAT_COLORS} from '@data/stats/stats';
import { Bug, SEVERITY, STATUS, Tags } from "@data/bugs/bugs";

const TAGS: Record<string, Tags> = {
    CONDUIT: { name: "Conduit of the Celestials", color: "#7ee5ff" },
    MOH: { name: "Master of Harmony", color: "#89ff7f" },
    HEALING_INCREASE: { name: "Healing Increase", color: "#fff871" },
    SPELL_QUEUE: { name: "Spell Queue", color: "#ff8c00" },
    MASTERY: { name: STATS.MASTERY, color: STAT_COLORS.MASTERY },
    HASTE: { name: STATS.HASTE, color: STAT_COLORS.HASTE },
    VERS: { name: STATS.VERS, color: STAT_COLORS.VERS },
    PETS: { name: "Pets", color: "#ff5445ff" }
};

const BUGS: Bug[] = [
    {
        spell: TALENTS.FLIGHT_OF_THE_RED_CRANE,
        affectedSpells: [TALENTS.UNITY_WITHIN, TALENTS.MANA_TEA],
        severity: SEVERITY.LOW,
        title: "Flight of the Red Crane from Unity Within doesn't proc Mana Tea",
        description:
            "Flight of the Red Crane, when activated from Unity Within, does not proc Mana Tea stacks. Should be 1 * 200%",
        tags: [TAGS.CONDUIT],
        notes: "Not sure if these are bugs or intended",
    },
    {
        spell: TALENTS.FLIGHT_OF_THE_RED_CRANE,
        affectedSpells: [TALENTS.MANA_TEA],
        severity: SEVERITY.MEDIUM,
        title: "Mana Tea Stack from Flight of the Red Crane cannot crit",
        description: "",
        tags: [TAGS.CONDUIT],
        notes: "Not sure if these are bugs or intended",
    },
    {
        spell: TALENTS.GUST_OF_MISTS,
        affectedSpells: [],
        severity: SEVERITY.MEDIUM,
        title: "Patch notes 20% buff only applied to tooltip",
        description:
            "20% buff from the patch notes was only applied to the tooltip, not the actual spellpower calculation",
        tags: [TAGS.MASTERY],
        status: STATUS.FIXED,
    },
    {
        spell: SPELLS.CELESTIAL_CONDUIT,
        affectedSpells: [],
        severity: SEVERITY.LOW,
        title: "Celestial Conduit doesn't heal if no allies weakened",
        description:
            "Celestial Conduit does not heal if no allies are weakened",
        tags: [TAGS.CONDUIT],
        notes: "Not sure if these are bugs or intended",
    },
    {
        spell: TALENTS.ASPECT_OF_HARMONY,
        affectedSpells: [],
        severity: SEVERITY.MEDIUM,
        title: "Aspect of Harmony doesn't apply to full health targets",
        description:
            "Aspect of Harmony does not apply to full health targets (even if they have a healing absorb on them) and does not proc off of several heals",
        tags: [TAGS.MOH],
        notes: "Not sure if these are bugs or intended",
        status: STATUS.FIXED,
    },
    {
        spell: SPELLS.CELESTIAL_CONDUIT,
        affectedSpells: [],
        severity: SEVERITY.HIGH,
        title: "Celestial Conduit channel cancelled by spell queue",
        description:
            "Celestial Conduit channel gets cancelled when a cast is spell-qued into it",
        tags: [TAGS.SPELL_QUEUE, TAGS.CONDUIT],
        status: STATUS.FIXED,
    },
    {
        spell: TALENTS.UNITY_WITHIN,
        affectedSpells: [
            TALENTS.COURAGE_OF_THE_WHITE_TIGER,
            TALENTS.STRENGTH_OF_THE_BLACK_OX,
            TALENTS.HEART_OF_THE_JADE_SERPENT,
            TALENTS.FLIGHT_OF_THE_RED_CRANE,
        ],
        severity: SEVERITY.CRITICAL,
        title: "Unity Within doesn't proc all celestial talents",
        description:
            "Unity within intermittently does not proc all of the celestial talents (ox, crane) when the channel expires",
        tags: [TAGS.CONDUIT],
        status: STATUS.FIXED,
    },
    {
        spell: TALENTS.CLARITY_OF_PURPOSE,
        affectedSpells: [TALENTS.GUST_OF_MISTS],
        severity: SEVERITY.LOW,
        title: "Clarity of Purpose doesn't trigger from various gusts",
        description:
            "Clarity of Purpose does not trigger from enveloping mist gusts, soothing mist gusts, crane style gusts, chiji gusts or jadefire stomp gusts",
        tags: [TAGS.MASTERY, TAGS.MOH],
        status: STATUS.FIXED,
    },
    {
        spell: TALENTS.BALANCED_STRATAGEM,
        affectedSpells: [
            SPELLS.CHI_BURST,
            SPELLS.JADEFIRE_STOMP,
            SPELLS.SOOTHING_MIST,
        ],
        severity: SEVERITY.MEDIUM,
        title: "Balanced Stratagem doesn't increase Dmg/Healing for some spells",
        description:
            "Does not increase Damage and Healing of several spells that consume buffs - Chi Burst, Jadefire Stomp, Soothing Mist. From 1 rising sun kick with Rapid Diffusion: Balanced Stratagem Pysical gets applied,",
        tags: [TAGS.HEALING_INCREASE, TAGS.MOH],
        lastBuildTested: "56819",
    },
    {
        spell: TALENTS.BALANCED_STRATAGEM,
        affectedSpells: [TALENTS.RAPID_DIFFUSION],
        severity: SEVERITY.LOW,
        title: "Rising Sun Kick w/ Rapid Diffusion adds/removes buffs",
        description:
            "With Rapid Diffusion Talented, Rising Sun Kick adds and removes several buff stacks in succession then consumed immediately and a Nature gets applied, consumed, and reapplied",
        tags: [TAGS.MOH],
        lastBuildTested: "57212",
    },
    {
        spell: TALENTS.BALANCED_STRATAGEM,
        affectedSpells: [TALENTS.MISTY_PEAKS, SPELLS.ENVELOPING_MIST],
        severity: SEVERITY.LOW,
        title: "Misty Peaks procs consume Physical, add Nature stack",
        description:
            "Misty Peaks Procs consume Physical and add a stack of Nature",
        tags: [TAGS.MOH],
        lastBuildTested: "56819",
    },
    {
        spell: TALENTS.BALANCED_STRATAGEM,
        affectedSpells: [TALENTS.RAPID_DIFFUSION, SPELLS.ENVELOPING_MIST],
        severity: SEVERITY.LOW,
        title: "Enveloping Mist w/ Rapid Diffusion procs 3 Nature stacks",
        description:
            "Hard Cast Enveloping Mist with Rapid diffusion procs 3 stacks of Nature. This is from Envelop apply and then the Rapid Diffusion Rem having travel time",
        tags: [TAGS.MOH],
        lastBuildTested: "57212",
    },
    {
        spell: TALENTS.PATH_OF_RESURGENCE,
        affectedSpells: [SPELLS.CHI_BURST],
        severity: SEVERITY.LOW,
        title: "Path of Resurgence tooltip says 50% instead of 25%",
        description:
            "Expected: Path of Resurgence states 25% increased vitality for 5s after chi wave, Actual: Path of Resurgence tooltip says 50% and its duration is refreshed on melee attacks",
        tags: [TAGS.MOH],
        status: STATUS.FIXED,
    },
    {
        spell: TALENTS.RESTORAL,
        affectedSpells: [],
        severity: SEVERITY.CRITICAL,
        title: "Restorals Spellpower was not increased when revival was reworked",
        description: "",
        tags: [],
        status: STATUS.FIXED,
    },
    {
        spell: TALENTS.OVERWHELMING_FORCE,
        affectedSpells: [
            TALENTS.TEACHINGS_OF_THE_MONASTERY,
            SPELLS.BLACKOUT_KICK,
        ],
        severity: SEVERITY.MEDIUM,
        title: "Overwhelming Force does not proc on Teachings of the Monastery Blackout Kicks",
        description: "",
        tags: [TAGS.MOH],
        status: STATUS.FIXED,
    },
    {
        spell: TALENTS.LOTUS_INFUSION,
        affectedSpells: [TALENTS.RAPID_DIFFUSION, SPELLS.RENEWING_MIST],
        severity: SEVERITY.HIGH,
        title: "Lotus Infusion doesn't increase RD ReMs by 2s",
        description: "Lotus Infusion does not increase the duration of Renewing Mist from Rapid Diffusion by 2s",
        tags: [],
        lastBuildTested: "56625",
    },
    {
        spell: SPELLS.VIVIFY,
        affectedSpells: [],
        severity: SEVERITY.HIGH,
        title: "Vivify can be cast while channeling other spells such as crackling jade lightning and mana tea",
        description: "",
        tags: [],
        status: STATUS.FIXED,
    },
    {
        spell: SPELLS.ENVELOPING_MIST,
        affectedSpells: [],
        severity: SEVERITY.HIGH,
        title: "Enveloping Mist can be cast while channeling other spells such as crackling jade lightning and mana tea",
        description: "",
        tags: [],
        status: STATUS.FIXED,
    },
    {
        spell: SPELLS.CHI_BURST,
        affectedSpells: [],
        severity: SEVERITY.MEDIUM,
        title: "Chi Burst sometimes does not heal",
        description: "",
        tags: [],
        status: STATUS.FIXED,
    },
    {
        spell: TALENTS.COURAGE_OF_THE_WHITE_TIGER,
        affectedSpells: [],
        severity: SEVERITY.MEDIUM,
        title: "Courage of the White Tiger is not healing for 200% of the damage dealt",
        description: "",
        tags: [TAGS.CONDUIT],
        status: STATUS.FIXED,
    },
    {
        spell: TALENTS.HEART_OF_THE_JADE_SERPENT,
        affectedSpells: [SPELLS.SHEILUNS_GIFT],
        severity: SEVERITY.CRITICAL,
        title: "Heart of the Jade Serpent stacks will fall off if Sheilun's Gift stacks to 8",
        description: "",
        tags: [TAGS.CONDUIT],
        lastBuildTested: "61967",
        notes: "Believe this is a static 64s timer for the drop off",
        status: STATUS.FIXED,
    },
    {
        spell: TALENTS.OVERWHELMING_FORCE,
        affectedSpells: [TALENTS.ASPECT_OF_HARMONY],
        severity: SEVERITY.LOW,
        title: "Overwhelming Force damage does not contribute vitality",
        description: "",
        tags: [TAGS.MOH],
        status: STATUS.FIXED,
    },
    {
        spell: TALENTS.COURAGE_OF_THE_WHITE_TIGER,
        affectedSpells: [],
        severity: SEVERITY.HIGH,
        title: "When Xuen procs he will attack nearby enemies the player is not in combat with",
        description: "",
        tags: [TAGS.CONDUIT],
        status: STATUS.FIXED,
    },
    {
        spell: TALENTS.SECRET_INFUSION,
        affectedSpells: [SPELLS.VIVIFY],
        severity: SEVERITY.MEDIUM,
        title: "Thunder Focus Tea + Vivify doesn't scale with mastery coefficient",
        description:
            "When Thunder Focus Tea is used on Vivify it only grants 29% mastery rather than 105% mastery meaning that the 7.7 mastery coeffcient is not being calculated into the increase.",
        tags: [TAGS.MASTERY],
        lastBuildTested: "57212",
        notes: "Makes Secret Infusion + Vivify practically useless",
    },
    {
        spell: TALENTS.TEAR_OF_MORNING,
        affectedSpells: [SPELLS.ENVELOPING_MIST],
        severity: SEVERITY.HIGH,
        title: "The cleave of Enveloping Mist is increased by the Enveloping Mist Hot even though they are the same spell ID.",
        description: "",
        tags: [],
        status: STATUS.FIXED,
    },
    {
        spell: TALENTS.TEAR_OF_MORNING,
        affectedSpells: [SPELLS.ENVELOPING_MIST],
        severity: SEVERITY.MEDIUM,
        title: "The cleave of Enveloping Mist doesn't scale with haste",
        description:
            "The '12% of Enveloping Mist' is calculated before haste is factored in and significatly reduces the cleaves value",
        tags: [TAGS.HASTE],
    },
    {
        spell: TALENTS.TEA_OF_SERENITY,
        affectedSpells: [
            TALENTS.RAPID_DIFFUSION,
            SPELLS.RENEWING_MIST,
            SPELLS.THUNDER_FOCUS_TEA,
        ],
        severity: SEVERITY.MEDIUM,
        title: "Rapid Diffusion ReMs do not become empowered but consume buff",
        description:
            "The buff for Renewing Mist gets consumed by Rapid Diffusion Rems without applying the Thunder Focus Tea effect to it",
        tags: [],
        lastBuildTested: "57212",
    },
    {
        spell: TALENTS.MENDING_PROLIFERATION,
        affectedSpells: [],
        severity: SEVERITY.LOW,
        title: "Mending Proliferation spreads to pets",
        description: "",
        tags: [TAGS.PETS],
        lastBuildTested: "57212",
        status: STATUS.FIXED,
    },
    {
        spell: TALENTS.MANTRA_OF_PURITY,
        affectedSpells: [TALENTS.GUST_OF_MISTS],
        severity: SEVERITY.LOW,
        title: "Gusts of Mist on player not increased by mantra",
        description: "",
        tags: [TAGS.MASTERY],
        status: STATUS.FIXED,
    },
    {
        spell: TALENTS.COURAGE_OF_THE_WHITE_TIGER,
        affectedSpells: [TALENTS.STRENGTH_OF_THE_BLACK_OX, SPELLS.YULON],
        severity: SEVERITY.HIGH,
        title: "Vivify after Invoke doesn't proc Strength of the Black Ox",
        description:
            "Casting vivify after invocation of celestial doesn't give a Strength of the Black Ox proc",
        tags: [TAGS.CONDUIT],
        status: STATUS.FIXED,
    },
    {
        spell: TALENTS.PEER_INTO_PEACE,
        affectedSpells: [SPELLS.VIVIFY, SPELLS.SOOTHING_MIST],
        severity: SEVERITY.MEDIUM,
        title: "Casting vivify on another target sometimes cancels channel",
        description:
            "Casting Vivify on another target intermittenly will cancel the soothing mist channel instead of changing the soothing mist target",
        tags: [],
        lastBuildTested: "57212",
    },
    {
        spell: TALENTS.MISTY_PEAKS,
        affectedSpells: [SPELLS.ENVELOPING_MIST],
        severity: SEVERITY.HIGH,
        title: "Misty Peaks allows instant Enveloping Mist on any target",
        description:
            "Talenting into Misty Peaks intermittently allows enveloping mist to be instant cast on any target while channeling abilities other than soothing mist",
        tags: [],
        status: STATUS.FIXED,
    },
    {
        spell: TALENTS.RESTORAL,
        affectedSpells: [],
        severity: SEVERITY.HIGH,
        title: "Restoral dispels magic debuffs",
        description: "Restoral is dispelling magic debuffs",
        tags: [],
        status: STATUS.FIXED,
    },
    {
        spell: TALENTS.COALESCENCE,
        affectedSpells: [TALENTS.ASPECT_OF_HARMONY],
        severity: SEVERITY.HIGH,
        title: "Coalescence doesn't increase healing to Aspect of Harmony targets",
        description:
            "Coalescence does not increase healing done to targets with Aspect of Harmony on them",
        tags: [TAGS.HEALING_INCREASE],
        status: STATUS.FIXED,
    },
    {
        spell: TALENTS.COALESCENCE,
        affectedSpells: [],
        severity: SEVERITY.HIGH,
        title: "Coalescence does not 'intensify'",
        description: "",
        tags: [],
        status: STATUS.FIXED,
    },
    {
        spell: TALENTS.ASPECT_OF_HARMONY,
        affectedSpells: [TALENTS.JADE_SERPENT_STATUE],
        severity: SEVERITY.LOW,
        title: "Jade Serpent Statue Soothing Mist doesn't contribute vitality",
        description:
            "Jade Serpent Statue's Soothing mist does not contribute vitality",
        tags: [],
        lastBuildTested: "57212",
    },
    {
        spell: TALENTS.ASPECT_OF_HARMONY,
        affectedSpells: [
            TALENTS.JADE_SERPENT_STATUE,
            SPELLS.SOOTHING_MIST,
            TALENTS.UNISON,
        ],
        severity: SEVERITY.MEDIUM,
        title: "Jade Serpent Statue/Unison healing don't apply Aspect of Harmony",
        description:
            "Jade Serpent Statue Soothing Mist and Unison healing do not apply aspect of harmony",
        tags: [],
        lastBuildTested: "57212",
    },
    {
        spell: SPELLS.JADEFIRE_STOMP,
        affectedSpells: [],
        severity: SEVERITY.MEDIUM,
        title: "Jadefire Stomp graphic variation causes target inconsistency",
        description:
            "Jadefire stomp's graphic variation causes inconsistency in the number of targets hit when cast from the exact same position.",
        tags: [],
        lastBuildTested: "57212",
    },
    {
        spell: TALENTS.AWAKENED_JADEFIRE,
        affectedSpells: [
            SPELLS.ENVELOPING_MIST,
            TALENTS.CHI_HARMONY,
            TALENTS.MENDING_PROLIFERATION,
            TALENTS.CELESTIAL_HARMONY,
        ],
        severity: SEVERITY.MEDIUM,
        title: "Awakened Jadefire healing not increased by healing boosts",
        description:
            "Awakened Jadefire healing is not increased by healing increases (enveloping mist, chi harmony, etc.)",
        notes:
            "Fixed in 62253, however doesn't get increased by Coalescence.",
        tags: [TAGS.HEALING_INCREASE],
        lastBuildTested: "62253",
        status: STATUS.FIXED,
    },
    {
        spell: TALENTS.COALESCENCE,
        affectedSpells: [TALENTS.ANCIENT_TEACHINGS, TALENTS.ASPECT_OF_HARMONY, TALENTS.AWAKENED_JADEFIRE],
        severity: SEVERITY.HIGH,
        title: "Aspect of Harmony doesn't amp Ancient Teachings or Awakened Jadefire",
        description:
            "Aspect of Harmony hot does not increase healing done by ancient teachings or Awakened Jadefire and the increased 20% damage done from the aspect of harmony dot does not transfer to ancient teachings healing",
        tags: [TAGS.HEALING_INCREASE],
        lastBuildTested: "62493",
        notes: "Not sure if this is a bug or intended - the addition of Awakened Jadefire to other amps and skipped over Coalescence points to intentional design",
    },
    {
        spell: TALENTS.JADE_EMPOWERMENT,
        affectedSpells: [],
        severity: SEVERITY.CRITICAL,
        title: "Cleave loses 800% buff if target dies",
        description:
            "If an enemy that is getting hit by the cleave dies, the remaining ticks of the channel lose their 800% damage buff",
        tags: [],
        status: STATUS.FIXED,
    },
    {
        spell: TALENTS.ANCIENT_TEACHINGS,
        affectedSpells: [],
        severity: SEVERITY.MEDIUM,
        title: "Ancient Teachings doesn't always heal for 30% of damage",
        description:
            "Baseline Ancient Teachings does not consistenly heal for 30% of the damage dealt. It is consistently higher on Tiger Palm and Blackout Kick and is sometimes lower on Rising Sun/Rushing Wind Kick",
        tags: [],
        lastBuildTested: "57292",
    },
    {
        spell: TALENTS.JADE_EMPOWERMENT,
        affectedSpells: [],
        severity: SEVERITY.CRITICAL,
        title: "2nd charge consumed if target dies",
        description:
            "If the player has two charges of JE and an enemy that is getting hit by the cleave dies, the second charge will be consumed in the same channel",
        tags: [],
        status: STATUS.FIXED,
    },
    {
        spell: TALENTS.RUSHING_WIND_KICK,
        affectedSpells: [TALENTS.ASPECT_OF_HARMONY],
        severity: SEVERITY.MEDIUM,
        title: "Rushing Wind Kick doesn't withdraw vitality to damage",
        description:
            "Rushing Wind Kick does not withdraw vitality to damage enemies",
        tags: [],
        lastBuildTested: "61967",
        status: STATUS.FIXED,
    },
    {
        spell: TALENTS.TEA_OF_PLENTY,
        affectedSpells: [SPELLS.RISING_SUN_KICK, SPELLS.THUNDER_FOCUS_TEA],
        severity: SEVERITY.MEDIUM,
        title: "Tea of Plenty RSK buff doesn't reduce cooldown as expected",
        description:
            "When a single stack of Tea of Plenty's Rising Sun Kick buff is consumed, it does not reduce the cooldown of rising sun kick or rushing wind kick. Casting RSK or RWK with the Rising Sun Kick buff consumes both the buff and Thunder Focus Tea in the same cast and reduces the Cooldown. If the player has two stacks of the Rising Sun Kick buff and does NOT have the Thunder Focus Tea buff, One stack will be consumed and the cooldown will be reduced.",
        tags: [],
        lastBuildTested: "57292",
    },
    {
        spell: TALENTS.MENDING_PROLIFERATION,
        affectedSpells: [],
        severity: SEVERITY.MEDIUM,
        title: "Spreads to non-injured targets and pets again",
        description: "Mending Proliferation with the PTR added range flags to its spell entry, which now reverted the change that it did not prefer pets. Currently, it is also spreading to full HP targets and targets that already have enveloping mist",
        tags: [],
        lastBuildTested: "62253",
    },
    {
        spell: TALENTS.OVERWHELMING_FORCE,
        affectedSpells: [],
        severity: SEVERITY.LOW,
        title: "Does not hit targets with absorbs",
        description: "Overwhelming Force does not hit targets with absorbs or shields on them",
        tags: [TAGS.MOH],
        lastBuildTested: "62493",
    },
    {
        spell: TALENTS.ASPECT_OF_HARMONY_T1,
        affectedSpells: [TALENTS.ASPECT_OF_HARMONY_T2, TALENTS.ASPECT_OF_HARMONY_T3],
        severity: SEVERITY.LOW,
        title: "Threshold buffs do not update or constantly update",
        description: "Aspect of Harmony's 1st threshold buff (450521) no longer sends combat log refresh events when vitality is being added to the pool. The 2nd (450526) and 3rd (450531) threshold buffs constantly swap between each other while vitality is being added to the pool, causing the two buff IDs to swap between each other",
        tags: [TAGS.MOH],
        lastBuildTested: "62493",
    },
    {
        spell: TALENTS.ASPECT_OF_HARMONY_WITHDRAW,
        affectedSpells: [],
        severity: SEVERITY.LOW,
        title: "Withdraw buff does not send combat log events",
        description: "Contrary to the fill buffs, the withdraw buff doesn't send any combat log events while its withdrawing vitality effectively making tracking have to use HEAL, PERIODIC_HEAL, DAMAGE, etc events in order to 'update' the buffs status",
        tags: [TAGS.MOH],
        lastBuildTested: "62493",
    },
    {
        spell: TALENTS.TEMPLE_TRAINING,
        affectedSpells: [SPELLS.SPINNING_CRANE_KICK],
        severity: SEVERITY.LOW,
        title: "Incorrectly increases SCK damage by 10%",
        description: "Taking effects from the Windwalker Temple Training, talenting this incorrectly increases Mistweaver SCK damage by 10% like it does on Windwalker.",
        tags: [TAGS.CONDUIT],
        lastBuildTested: "62748",
    },
    {
        spell: TALENTS.ANCIENT_TEACHINGS,
        affectedSpells: [TALENTS.SECRET_INFUSION, TALENTS.INNER_COMPASS],
        severity: SEVERITY.MEDIUM,
        title: "Versatility double dips with Ancient Teachings",
        description: "Versatility gains from several sources (Secret Infusion, Inner Compass, Mark of the Wild, etc) double dips on Ancient Teachings - it increases the damage you deal which converts into Ancient Teachings healing, then that is increased by the extra Versatility % increase",
        tags: [TAGS.VERS],
        lastBuildTested: "62748",
    },
    {
        spell: SPELLS.CELESTIAL_CONDUIT,
        affectedSpells: [],
        severity: SEVERITY.MEDIUM,
        title: "Channel randomly cancels, usually from spellqueue",
        description: "Celestial Conduit can randomly cancel its channel likely due to spell queuing. Anecdotally has cancelled from a previous Evenloping Mist cast directly into Conduit. The suspection is from Rapid Diffusion ReM being created from the Enveloping Mist",
        tags: [TAGS.CONDUIT],
        lastBuildTested: "62748",
    },
];  

export default BUGS;
